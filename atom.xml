<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Conan_の空间</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://zonzpoo.github.io/"/>
  <updated>2016-08-30T16:06:33.000Z</updated>
  <id>http://zonzpoo.github.io/</id>
  
  <author>
    <name>Conan_</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>python的魔术方法</title>
    <link href="http://zonzpoo.github.io/2016/08/27/python%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/"/>
    <id>http://zonzpoo.github.io/2016/08/27/python魔术方法/</id>
    <published>2016-08-27T15:15:25.000Z</published>
    <updated>2016-08-30T16:06:33.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;img src=&quot;/images/church1.jpg&quot; alt=&quot;photos&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;内置方法与对象的特殊方法(以下代码的运行环境为python3)&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;add-和-sub&quot;&gt;&lt;a href=&quot;#add-和-sub&quot; class=&quot;headerlink&quot; title=&quot;__add__  和  __sub__&quot;&gt;&lt;/a&gt;__add__  和  __sub__&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Complex&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, x)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._x = x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__add__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, other)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&quot;add&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Complex(self._x + other._x)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__sub__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, other)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&quot;sub&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Complex(self._x - other._x)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; self._x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a = Complex(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;b = Complex(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c = a + b&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;add    &lt;span class=&quot;comment&quot;&gt;# 调用__add__,打印出&quot;add&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c.print()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;d = a - b&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;sub    &lt;span class=&quot;comment&quot;&gt;# 调用__sub__,打印出&quot;sub&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;d.print()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;bool-和-len&quot;&gt;&lt;a href=&quot;#bool-和-len&quot; class=&quot;headerlink&quot; title=&quot;__bool__ 和 __len__&quot;&gt;&lt;/a&gt;__bool__ 和 __len__&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Complex&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__bool__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&#39;bool&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c = Complex()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bool(c)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;bool   &lt;span class=&quot;comment&quot;&gt;# 调用__bool__,打印出&quot;bool&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Complex&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&#39;len&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;x = Complex()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;len(x)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;len   &lt;span class=&quot;comment&quot;&gt;# 调用__len__,打印出&quot;len&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bool(x)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;len   &lt;span class=&quot;comment&quot;&gt;# 注意对实例调用bool,如果没有定义__bool__方法,会自动调用__len__方法&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;call&quot;&gt;&lt;a href=&quot;#call&quot; class=&quot;headerlink&quot; title=&quot;__call__&quot;&gt;&lt;/a&gt;__call__&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 简单使用&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Complex&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, x)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._x = x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__call__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&quot;bili&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; self._x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c = Complex(&lt;span class=&quot;string&quot;&gt;&quot;drink&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;bili   &lt;span class=&quot;comment&quot;&gt;# 调用__call__,打印出&quot;bili&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;drink&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 类装饰器使用(定义一个单例类)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Singleton&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, cls)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.cls = cls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.instance = &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__call__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, *args, **kwargs)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(self.instance)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; self.instance:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.instance = self.cls(*args, **kwargs)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; self.instance&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@Singleton&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;A&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# NewA = Singleton(A)     &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;pass&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a1 = A()   &lt;span class=&quot;comment&quot;&gt;# a1 = NewA(), 注意此时A相当于Singleton初始化传入A后的实例&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;# 调用__call__,打印出&quot;self.instance&quot;,此时为None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a2 = A()   &lt;span class=&quot;comment&quot;&gt;# a2 = NewA()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&amp;lt;__main__.A object at &lt;span class=&quot;number&quot;&gt;0x106ac3b38&lt;/span&gt;&amp;gt;   &lt;span class=&quot;comment&quot;&gt;# 调用__call__,打印出&quot;self.instance&quot;,此时为a1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a1 == a2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;# a1 = a2, 实际上第二次实例化的时候直接返回的第一次的实例&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;str-和-repr&quot;&gt;&lt;a href=&quot;#str-和-repr&quot; class=&quot;headerlink&quot; title=&quot;__str__  和  __repr__&quot;&gt;&lt;/a&gt;__str__  和  __repr__&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Complex&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, x, y)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.x = x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.y = y&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__add__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, other)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Complex(self.x + other.x, self.y + other.y)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&quot;柯南&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; self.x &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;&amp;#123;0&amp;#125; + &amp;#123;1&amp;#125;i&#39;&lt;/span&gt;.format(self.x, self.y)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;&amp;#123;0&amp;#125; - &amp;#123;1&amp;#125;i&#39;&lt;/span&gt;.format(self.x, self.y)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# __repr__ = __str__&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c = Complex(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;str(c) / print(c)  &lt;span class=&quot;comment&quot;&gt;# print方法调用__str__&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;柯南    &lt;span class=&quot;comment&quot;&gt;# 调用__str__,打印出&quot;柯南&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;1 + 2i&#39;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&amp;lt;__main__.Complex at &lt;span class=&quot;number&quot;&gt;0x106ac3ef0&lt;/span&gt;&amp;gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 去掉__repr__ = __str__前的注释符号&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;1 + 2i&#39;&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;# 直接输入c实际上会调用__repr__方法&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;enter-exit-with语法&quot;&gt;&lt;a href=&quot;#enter-exit-with语法&quot; class=&quot;headerlink&quot; title=&quot;__enter__, __exit__(with语法)&quot;&gt;&lt;/a&gt;__enter__, __exit__(with语法)&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Complex&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, x)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._x = x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__enter__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&quot;starting&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; self._x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__exit__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, exc_type, exc_val, exc_tb)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(exc_type, exc_val, exc_tb)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&quot;ending&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; Complex(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; x:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    print(x)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;starting     &lt;span class=&quot;comment&quot;&gt;# 进入__enter__&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;            &lt;span class=&quot;comment&quot;&gt;# print 打印出 self._x&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;ending    &lt;span class=&quot;comment&quot;&gt;# 进入__exit__, print 打印出 ending&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;contextlib-contextmanager功能简单实现&quot;&gt;&lt;a href=&quot;#contextlib-contextmanager功能简单实现&quot; class=&quot;headerlink&quot; title=&quot;contextlib.contextmanager功能简单实现&quot;&gt;&lt;/a&gt;contextlib.contextmanager功能简单实现&lt;/h2&gt;&lt;h3 id=&quot;contextlib-contextmanager&quot;&gt;&lt;a href=&quot;#contextlib-contextmanager&quot; class=&quot;headerlink&quot; title=&quot;contextlib.contextmanager&quot;&gt;&lt;/a&gt;contextlib.contextmanager&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; contextlib &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; contextmanager&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@contextmanager&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;finally&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&#39;exit&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; test() &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; t:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    print(t)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;exit&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;简单实现方法1&quot;&gt;&lt;a href=&quot;#简单实现方法1&quot; class=&quot;headerlink&quot; title=&quot;简单实现方法1&quot;&gt;&lt;/a&gt;简单实现方法1&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Manager&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, fn, *args, **kwargs)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._fn = fn(*args, **kwargs)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__enter__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; next(self._fn)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__exit__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, exc_type, exc_val, exc_tb)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(exc_type, exc_val, exc_tb)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;manager&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(fn)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;    @wraps(fn)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;wrap&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(*args, **kwargs)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Manager(fn, *args, **kwargs)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; wrap&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@manager&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;finally&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&#39;exit&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;简单实现方法2&quot;&gt;&lt;a href=&quot;#简单实现方法2&quot; class=&quot;headerlink&quot; title=&quot;简单实现方法2&quot;&gt;&lt;/a&gt;简单实现方法2&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ContextManager&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, fn, *args, **kwargs)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._fn = fn(*args, **kwargs)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__enter__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; next(self._fn)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__exit__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, exc_type, exc_val, exc_tb)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(exc_type, exc_val, exc_tb)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Manager&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&#39;&#39;&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    def manager(fn)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      @wraps(fn)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      def newtest(*args, **kwargs):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          return fn(*args, **kwargs)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      return newtest&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &#39;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, fn)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        wraps(fn)(self)    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__call__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, *args, **kwargs)&lt;/span&gt;:&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;# 此处 fn == self.__wrapped__&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ContextManager(self.__wrapped__, *args, **kwargs)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@Manager&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;      &lt;span class=&quot;comment&quot;&gt;# newtest = Manager(test)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;finally&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&#39;exit&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; test() &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; t:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    print(t)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;exit&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;getattribute-getattr&quot;&gt;&lt;a href=&quot;#getattribute-getattr&quot; class=&quot;headerlink&quot; title=&quot;__getattribute__, __getattr__&quot;&gt;&lt;/a&gt;__getattribute__, __getattr__&lt;/h2&gt;&lt;p&gt;stackoverflow关于[__getattribute__和__getattr__]的区别回答:&lt;br&gt;(&lt;a href=&quot;http://stackoverflow.com/questions/3278077/difference-between-getattr-vs-getattribute&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://stackoverflow.com/questions/3278077/difference-between-getattr-vs-getattribute&lt;/a&gt;)&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;A key difference between __getattr__ and __getattribute__ is that __getattr__ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;is only invoked if the attribute wasn&amp;apos;t found the usual ways. &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;It&amp;apos;s good for implementing a fallback for missing attributes, and is probably &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;the one of two you want.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;__getattribute__ is invoked before looking at the actual attributes on the &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;object, and so can be tricky to implement correctly. &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;You can end up in infinite recursions very easily. New-style classes derive &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;from object, old-style classes are those in Python 2.x with no explicit &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;base class. But the distinction between old-style and new-style classes &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;is not the important one when choosing between __getattr__ and &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;__getattribute__. You almost certainly want __getattr__.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(object)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.test = &lt;span class=&quot;string&quot;&gt;&quot;init test&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.test2 = &lt;span class=&quot;string&quot;&gt;&quot;init test2&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__getattribute__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, name)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; name == &lt;span class=&quot;string&quot;&gt;&#39;test&#39;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;getattribute test&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; object.__getattribute__(self, name)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__getattr__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, name)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; name == &lt;span class=&quot;string&quot;&gt;&#39;test&#39;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;getattr test&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; name == &lt;span class=&quot;string&quot;&gt;&#39;test3&#39;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;getattr test3&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;lambda&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;default test for &amp;#123;0&amp;#125;&quot;&lt;/span&gt;.format(name)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;d = D()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;d.test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;getattribute test&#39;&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;# 默认调用__getattribute__&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;d.test2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;init test2&#39;&lt;/span&gt;          &lt;span class=&quot;comment&quot;&gt;# 返回object.__getattribute__(self, name)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;d.test3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;getattr test3&#39;&lt;/span&gt;       &lt;span class=&quot;comment&quot;&gt;# 实例没有test3属性，调用__getattr__&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;d.test4()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;default test for test4&#39;&lt;/span&gt;   &lt;span class=&quot;comment&quot;&gt;# __getattr__没有匹配到test4，返回匿名函数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;get-set-描述符&quot;&gt;&lt;a href=&quot;#get-set-描述符&quot; class=&quot;headerlink&quot; title=&quot;__get__, __set__(描述符)&quot;&gt;&lt;/a&gt;__get__, __set__(描述符)&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 描述符对Propety的实现&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Propety&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, fget=None, fset=None, fdel=None)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._fget = fget&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._fset = fset&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._fdel = fdel&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, ins, cls)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; ins:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; self&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; callable(self._fget):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;raise&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; self._fget(ins)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__set__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, ins, value)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; ins:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; self&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; callable(self._fset):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;raise&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; self._fset(ins, value)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__delete__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, ins)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; callable(self._fdel):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;raise&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._fdel(ins)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;setter&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, fset)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Propety(self._fget, fset, self._fdel)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;deleter&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, fdel)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Propety(self._fget, self._fset, fdel)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;A&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, x)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._x = x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;    @Propety             # Propety(p, None, None)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; self._x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt; AttributeError:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;AttributeError&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;    @p.setter            # Propety(p, sp, None) 方便区分,此处p命名为sp&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;sp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, value)&lt;/span&gt;:&lt;/span&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._x = value&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;    @p.deleter           # Propety(p, None, dp) 方便区分,此处p命名为dp&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;dp&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;del&lt;/span&gt; self._x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;a = A(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;a.p         &lt;span class=&quot;comment&quot;&gt;# =&amp;gt; Propety(p, None, None).__get__(a, A) =&amp;gt; self._x&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;a.sp = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;    &lt;span class=&quot;comment&quot;&gt;# =&amp;gt; Propety(p, sp, None).__set__(a) =&amp;gt; self._x = 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;a.p   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;del&lt;/span&gt; a.dp    &lt;span class=&quot;comment&quot;&gt;# =&amp;gt; Propety(p, None, dp).__delete__(a, 3) =&amp;gt; del self._x&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;a.p&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;AttributeError&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/church1.jpg&quot; alt=&quot;photos&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;内置方法与对象的特殊方法(以下代码的运行环境为python3)&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://zonzpoo.github.io/categories/python/"/>
    
    
      <category term="魔术方法" scheme="http://zonzpoo.github.io/tags/%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>pycharm快捷键记录</title>
    <link href="http://zonzpoo.github.io/2016/08/13/pycharm%E5%BF%AB%E6%8D%B7%E9%94%AE%E8%AE%B0%E5%BD%95/"/>
    <id>http://zonzpoo.github.io/2016/08/13/pycharm快捷键记录/</id>
    <published>2016-08-13T15:03:17.000Z</published>
    <updated>2016-08-13T15:39:28.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;img src=&quot;/images/books1.jpg&quot; alt=&quot;books1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;查找&quot;&gt;&lt;a href=&quot;#查找&quot; class=&quot;headerlink&quot; title=&quot;查找&quot;&gt;&lt;/a&gt;查找&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;shift+shift：&lt;/strong&gt;  全项目搜索&lt;br&gt;&lt;strong&gt;command+shift+n：&lt;/strong&gt;  快速搜索文件名&lt;br&gt;&lt;strong&gt;command+n：&lt;/strong&gt;  快速搜索一个类&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;command+o：&lt;/strong&gt;  列出类(包括继承的类)所有的方法&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/books1.jpg&quot; alt=&quot;books1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;查找&quot;&gt;&lt;a href=&quot;#查找&quot; class=&quot;headerlink&quot; title=&quot;查找&quot;&gt;&lt;/a&gt;查找&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;shift+shift
    
    </summary>
    
      <category term="python" scheme="http://zonzpoo.github.io/categories/python/"/>
    
    
      <category term="pycharm" scheme="http://zonzpoo.github.io/tags/pycharm/"/>
    
  </entry>
  
  <entry>
    <title>一次系统iowait高的处理</title>
    <link href="http://zonzpoo.github.io/2016/07/30/%E4%B8%80%E6%AC%A1iowait%E9%AB%98%E7%9A%84%E5%A4%84%E7%90%86/"/>
    <id>http://zonzpoo.github.io/2016/07/30/一次iowait高的处理/</id>
    <published>2016-07-30T06:50:25.000Z</published>
    <updated>2016-08-13T15:59:19.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;img src=&quot;/images/photos.jpg&quot; alt=&quot;photos&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;一次收到告警显示服务器CPU iowait time过大,一会又恢复了,大概每5分钟报警一次&lt;/p&gt;
&lt;h2 id=&quot;处理过程&quot;&gt;&lt;a href=&quot;#处理过程&quot; class=&quot;headerlink&quot; title=&quot;处理过程&quot;&gt;&lt;/a&gt;处理过程&lt;/h2&gt;&lt;p&gt;使用iotop查看磁盘IO操作&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iotop -d 1 -obk -a&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;blockquote&gt;
&lt;p&gt;-d 表示刷新时间&lt;br&gt;-o 表示只显示当前有io操作的进程&lt;br&gt;-b 表示非交互模式&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Actual DISK READ:       0.00 K/s | Actual DISK WRITE:       0.00 K/s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN      IO    COMMAND&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  120 be/3 root          0.00 K     24.00 K  0.00 %  0.23 % [jbd2/vda1-8]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 3107 be/4 root          0.00 K  40000.00 K  0.00 %  0.00 % redis-rdb-bgsave *:6379    .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11183 be/4 root          0.00 K      4.00 K  0.00 %  0.00 % redis-server *:6379&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Total DISK READ :       0.00 K/s | Total DISK WRITE :   44605.33 K/s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Actual DISK READ:       0.00 K/s | Actual DISK WRITE:       0.00 K/s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN      IO    COMMAND&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  120 be/3 root          0.00 K     24.00 K  0.00 %  0.20 % [jbd2/vda1-8]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 3107 be/4 root          0.00 K  85000.00 K  0.00 %  0.00 % redis-rdb-bgsave *:6379    .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11183 be/4 root          0.00 K      4.00 K  0.00 %  0.00 % redis-server *:6379&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Total DISK READ :       0.00 K/s | Total DISK WRITE :   48190.76 K/s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Actual DISK READ:       0.00 K/s | Actual DISK WRITE:       0.00 K/s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN      IO    COMMAND&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  120 be/3 root          0.00 K     24.00 K  0.00 %  0.18 % [jbd2/vda1-8]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 3107 be/4 root          0.00 K 133600.00 K  0.00 %  0.00 % redis-rdb-bgsave *:6379    .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11183 be/4 root          0.00 K      4.00 K  0.00 %  0.00 % redis-server *:6379&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可以看到有io操作的进程pid&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ls -l /proc/11183/fd/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;lrwx------ 1 root root 64 Jul 30 13:06 35 -&amp;gt; socket:[1069353]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;l-wx------ 1 root root 64 Jul 30 13:06 4 -&amp;gt; /data/redis-6379/temp-3107.rdb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;推断正在redis-server正在bgsave持久化,查看redis的log&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;11183:M 30 Jul 12:56:49.486 * 10000 changes in 60 seconds. Saving...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11183:M 30 Jul 12:56:49.566 * Background saving started by pid 24361&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24361:C 30 Jul 12:58:00.946 * DB saved on disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24361:C 30 Jul 12:58:01.008 * RDB: 25 MB of memory used by copy-on-write&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11183:M 30 Jul 12:58:01.105 * Background saving terminated with success&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11183:M 30 Jul 12:59:19.571 * 10000 changes in 60 seconds. Saving...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11183:M 30 Jul 12:59:19.638 * Background saving started by pid 27185&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27185:C 30 Jul 13:00:28.508 * DB saved on disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27185:C 30 Jul 13:00:28.554 * RDB: 24 MB of memory used by copy-on-write&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11183:M 30 Jul 13:00:28.678 * Background saving terminated with success&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11183:M 30 Jul 13:01:47.746 * 10000 changes in 60 seconds. Saving...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11183:M 30 Jul 13:01:47.826 * Background saving started by pid 29767&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29767:C 30 Jul 13:02:58.917 * DB saved on disk&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可以看到,数据更新过快,数量(changes)达到save参数指定的10000个,频繁触发save流程,由此推断可能前一次save未完成又需要新的save,造成iowait高&lt;br&gt;至此热调整线上redis的save的保存策略&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CONFIG SET save &amp;quot;900 1 300 10 60 20000&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/photos.jpg&quot; alt=&quot;photos&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;一次收到告警显示服务器CPU iowait time过大,一会又恢复了,大概每5分钟报警一次&lt;/p&gt;
&lt;h2 id=&quot;处理过程&quot;&gt;&lt;a href=&quot;#处理过程&quot; class=&quot;headerlink&quot; title=&quot;处理过程&quot;&gt;&lt;/a&gt;处理过程&lt;/h2&gt;&lt;p&gt;使用iotop查看磁盘IO操作&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iotop -d 1 -obk -a&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://zonzpoo.github.io/categories/linux/"/>
    
    
      <category term="进程" scheme="http://zonzpoo.github.io/tags/%E8%BF%9B%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>urlsafe_b64encode和urlsafe_b64decode的编解码</title>
    <link href="http://zonzpoo.github.io/2016/05/29/urlsafe-b64encode%E5%92%8Curlsafe-b64decode%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81/"/>
    <id>http://zonzpoo.github.io/2016/05/29/urlsafe-b64encode和urlsafe-b64decode的编解码/</id>
    <published>2016-05-29T06:56:23.000Z</published>
    <updated>2016-05-29T07:24:46.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;某些情况，比如需要将路径’/var/log/messages’作为ZooKeeper的znode创建，ZooKeeper采用了类似文件系统的结构，此时需要将路径进行编码传入&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;实现方法&quot;&gt;&lt;a href=&quot;#实现方法&quot; class=&quot;headerlink&quot; title=&quot;实现方法&quot;&gt;&lt;/a&gt;实现方法&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;以下测试代码环境是python3&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;encode和decode函数&quot;&gt;&lt;a href=&quot;#encode和decode函数&quot; class=&quot;headerlink&quot; title=&quot;encode和decode函数&quot;&gt;&lt;/a&gt;encode和decode函数&lt;/h3&gt;&lt;p&gt;python中，使用decode()和encode()来进行解码和编码&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;In [19]: s = &amp;apos;中文&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [20]: s1 = s.encode() &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [21]: s1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[21]: b&amp;apos;\xe4\xb8\xad\xe6\x96\x87&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [22]: s1.decode()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[22]: &amp;apos;中文&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;str.encode(encoding=”utf-8”, errors=”strict”) 默认使用’utf-8’进行编码&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;urlsafe-b64encode和urlsafe-b64decode函数&quot;&gt;&lt;a href=&quot;#urlsafe-b64encode和urlsafe-b64decode函数&quot; class=&quot;headerlink&quot; title=&quot;urlsafe_b64encode和urlsafe_b64decode函数&quot;&gt;&lt;/a&gt;urlsafe_b64encode和urlsafe_b64decode函数&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;In [1]: from base64 import urlsafe_b64decode&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [2]: from base64 import urlsafe_b64encode&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [3]: filename=&amp;apos;/var/log/message&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [6]: urlsafe_b64encode(filename.encode())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[6]: b&amp;apos;L3Zhci9sb2cvbWVzc2FnZQ==&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [8]: urlsafe_b64decode(b&amp;apos;L3Zhci9sb2cvbWVzc2FnZQ==&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[8]: b&amp;apos;/var/log/message&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;In [9]: (urlsafe_b64decode(b&amp;apos;L3Zhci9sb2cvbWVzc2FnZQ==&amp;apos;)).decode()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Out[9]: &amp;apos;/var/log/message&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;使用urlsafe_b64encode进行编码，Encode string s using a URL-safe alphabet, which substitutes - instead of + and __ instead of / in the standard Base64 alphabet. The result can still contain =.&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;某些情况，比如需要将路径’/var/log/messages’作为ZooKeeper的znode创建，ZooKeeper采用了类似文件系统的结构，此时需要将路径进行编码传入&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://zonzpoo.github.io/categories/python/"/>
    
    
      <category term="base64" scheme="http://zonzpoo.github.io/tags/base64/"/>
    
  </entry>
  
  <entry>
    <title>配置vsftpd遇到的一些问题</title>
    <link href="http://zonzpoo.github.io/2016/05/08/%E9%85%8D%E7%BD%AEvsftpd%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/"/>
    <id>http://zonzpoo.github.io/2016/05/08/配置vsftpd遇到的一些问题/</id>
    <published>2016-05-07T16:12:47.000Z</published>
    <updated>2016-05-29T06:35:00.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;vsftpd是Very_Secure_FTP的缩写，支持anonymous帐号登录和本地实体帐号登录，通过简单的配置，即可以运行。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;配置-debian系统&quot;&gt;&lt;a href=&quot;#配置-debian系统&quot; class=&quot;headerlink&quot; title=&quot;配置(debian系统)&quot;&gt;&lt;/a&gt;配置(debian系统)&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;listen=YES&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;anonymous_enable=NO&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;local_enable=YES&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;write_enable=YES&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;local_umask=022&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dirmessage_enable=YES&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;use_localtime=YES&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;xferlog_enable=YES&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;xferlog_std_format=True&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;xferlog_file=/var/log/vsftpd.log&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;connect_from_port_20=YES&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;data_connection_timeout=120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pam_service_name=vsftpd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pasv_enable=YES&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;userlist_enable=YES&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;userlist_deny=NO&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;userlist_file=/etc/vsftpd.userlist&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;所有的参数可通过man vsftpd.conf查看&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;遇到的问题&quot;&gt;&lt;a href=&quot;#遇到的问题&quot; class=&quot;headerlink&quot; title=&quot;遇到的问题&quot;&gt;&lt;/a&gt;遇到的问题&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;通过配置userlist_enable，vsftpd会从userlist_file给定的文件内读取用户名，&lt;br&gt;此用户登陆ftp会被要求输入密码如果userlist_enable激活后，userlist_deny&lt;br&gt;如果被设置成NO，那些不在userlist_file里面的用户会被拒绝登陆&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;/etc/pam.d/下的文件vsftpd中配置的pam_shells.so会检查登陆的ftp用户是否&lt;br&gt;有合法的shell，所以需要确保设置的ftp用户的shell存在/etc/shells文件中&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果在配置文件启用chroot_local_user=YES，将本地用户禁锢在其家目录中，用户&lt;br&gt;在登陆ftp后会报错:500 OOPS: vsftpd: refusing to run with writable&lt;br&gt;root inside chroot()，此时需要启用allow_writeable_chroot，当在vsftpd3之前&lt;br&gt;的版本allow_writeable_chroot选项在配置文件是不可用(debian7默认为2.3.5-3版本)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;vsftpd是Very_Secure_FTP的缩写，支持anonymous帐号登录和本地实体帐号登录，通过简单的配置，即可以运行。&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://zonzpoo.github.io/categories/linux/"/>
    
    
      <category term="ftp" scheme="http://zonzpoo.github.io/tags/ftp/"/>
    
  </entry>
  
  <entry>
    <title>关于python元类</title>
    <link href="http://zonzpoo.github.io/2016/04/29/%E5%85%B3%E4%BA%8Epython%E5%85%83%E7%B1%BB/"/>
    <id>http://zonzpoo.github.io/2016/04/29/关于python元类/</id>
    <published>2016-04-29T06:51:29.000Z</published>
    <updated>2016-08-13T15:17:29.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;关于元类(metaclass)的一些说法:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;元类是类的类&lt;/li&gt;
&lt;li&gt;元类是用来控制如何创建类的&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;本文例子参考&lt;a href=&quot;http://www.liaoxuefeng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;廖雪峰官方网站&lt;/a&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;内建元类type&quot;&gt;&lt;a href=&quot;#内建元类type&quot; class=&quot;headerlink&quot; title=&quot;内建元类type&quot;&gt;&lt;/a&gt;内建元类type&lt;/h2&gt;&lt;p&gt;type实际上是Python的一个内建元类，用来直接指导类的生成，用法如下:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;type(类名，父类的元祖，包含属性的字典)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt; cls = type(&#39;classname&#39;，(object，)，&amp;#123;&#39;attr&#39;:&#39;hello world&#39;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt; cls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;class &#39;__main__.classname&#39;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt; cls_instance = cls()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt; cls_instance&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;__main__.classname object at 0x103ee1b50&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt; cls_instance.attr&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&#39;hello world&#39;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;注: 通过type()函数创建的类和直接写class是完全一样的，因为Python解释器遇到class定义时，仅仅是扫描一下class定义的语法，然后调用type()函数创建出class&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;自定义metaclass&quot;&gt;&lt;a href=&quot;#自定义metaclass&quot; class=&quot;headerlink&quot; title=&quot;自定义metaclass&quot;&gt;&lt;/a&gt;自定义metaclass&lt;/h2&gt;&lt;p&gt;除了使用内建的元类type，也可以通过集成type来定义元类&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;l = list()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;l.append(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;l&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;定义l为list的实例，并给l增加元素1，利用metaclass重新自定义类(MyList)创建的list增加add方法&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(s, value)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; s  &lt;span class=&quot;comment&quot;&gt;# MyList的实例&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; value  &lt;span class=&quot;comment&quot;&gt;# 传入的值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; s.append(value)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ListMetaclass&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(type)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__new__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(cls, name, bases, dict)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; cls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; name  &lt;span class=&quot;comment&quot;&gt;# 被生成的类的类名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; bases  &lt;span class=&quot;comment&quot;&gt;# 被生成的类继承的父类集合&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; dict  &lt;span class=&quot;comment&quot;&gt;# 类的方法集合&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        dict[&lt;span class=&quot;string&quot;&gt;&#39;add&#39;&lt;/span&gt;] = add  &lt;span class=&quot;comment&quot;&gt;# 增加add方法，默认第一个参数是生成的类的实例&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; super(ListMetaclass, cls).__new__(cls, name, bases, dict)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MyList&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(list)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    __metaclass__ = ListMetaclass&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;pass&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;l = MyList()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;l.add(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; l&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;运行结果:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;class &amp;apos;__main__.ListMetaclass&amp;apos;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;MyList&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&amp;lt;type &amp;apos;list&amp;apos;&amp;gt;,)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&amp;apos;__module__&amp;apos;: &amp;apos;__main__&amp;apos;, &amp;apos;__metaclass__&amp;apos;: &amp;lt;class &amp;apos;__main__.ListMetaclass&amp;apos;&amp;gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[1]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;简单的ORM实现&quot;&gt;&lt;a href=&quot;#简单的ORM实现&quot; class=&quot;headerlink&quot; title=&quot;简单的ORM实现&quot;&gt;&lt;/a&gt;简单的ORM实现&lt;/h2&gt;&lt;h3 id=&quot;定义Field基类及其他各种类型，负责保存数据库表的字段名和字段类型&quot;&gt;&lt;a href=&quot;#定义Field基类及其他各种类型，负责保存数据库表的字段名和字段类型&quot; class=&quot;headerlink&quot; title=&quot;定义Field基类及其他各种类型，负责保存数据库表的字段名和字段类型&quot;&gt;&lt;/a&gt;定义Field基类及其他各种类型，负责保存数据库表的字段名和字段类型&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Field&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(object)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, name, type)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.name = name&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._type = type&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;&amp;#123;0&amp;#125;:&amp;#123;1&amp;#125;&#39;&lt;/span&gt;.format(self.__class__.__name__, self.name)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;StringField&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Field)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, name)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        super(StringField, self).__init__(name, &lt;span class=&quot;string&quot;&gt;&#39;varchar(100)&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;IntegerField&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Field)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, name)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        super(IntegerField, self).__init__(name, &lt;span class=&quot;string&quot;&gt;&#39;bigint&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;定义元类&quot;&gt;&lt;a href=&quot;#定义元类&quot; class=&quot;headerlink&quot; title=&quot;定义元类&quot;&gt;&lt;/a&gt;定义元类&lt;/h3&gt;&lt;p&gt;主要通过元类找到最后定义的model中的各个属性&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ModelMetaclass&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(type)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__new__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(cls, name, bases, attrs)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; name == &lt;span class=&quot;string&quot;&gt;&#39;Model&#39;&lt;/span&gt;:  &lt;span class=&quot;comment&quot;&gt;# 排除对Model类的修改&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; super(ModelMetaclass, cls).__new__(cls, name, bases, attrs)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&#39;Found model: &amp;#123;0&amp;#125;&#39;&lt;/span&gt;.format(name))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mappings = dict()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; k, v &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; attrs.items():  &lt;span class=&quot;comment&quot;&gt;# 查找生成类的所有属性并保存到mappings&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; isinstance(v, Field):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                print(&lt;span class=&quot;string&quot;&gt;&#39;Found mapping: &amp;#123;0&amp;#125; ==&amp;gt; &amp;#123;1&amp;#125;&#39;&lt;/span&gt;.format(k, v))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mappings[k] = v&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; k &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; mappings.keys():&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            attrs.pop(k)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        attrs[&lt;span class=&quot;string&quot;&gt;&#39;__mappings__&#39;&lt;/span&gt;] = mappings  &lt;span class=&quot;comment&quot;&gt;# 保存属性和列的映射关系&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        attrs[&lt;span class=&quot;string&quot;&gt;&#39;__table__&#39;&lt;/span&gt;] = name  &lt;span class=&quot;comment&quot;&gt;# 假设表名和类名一致&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; super(ModelMetaclass, cls).__new__(cls, name, bases, attrs)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(dict)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    __metaclass__ = ModelMetaclass&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, **kw)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        super(Model, self).__init__(**kw)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# print self&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        fields = []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        params = []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        args = []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; k, v &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; self.__mappings__.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            fields.append(v.name)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            params.append(&lt;span class=&quot;string&quot;&gt;&#39;?&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            args.append(getattr(self, k, &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        sql = &lt;span class=&quot;string&quot;&gt;&#39;insert into &amp;#123;0&amp;#125; &amp;#123;1&amp;#125; values &amp;#123;2&amp;#125;&#39;&lt;/span&gt;.format(self.__table__, &lt;span class=&quot;string&quot;&gt;&#39;,&#39;&lt;/span&gt;.join(fields), &lt;span class=&quot;string&quot;&gt;&#39;,&#39;&lt;/span&gt;.join(params))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&#39;SQL: &amp;#123;0&amp;#125;&#39;&lt;/span&gt;.format(sql))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&#39;ARGS: &amp;#123;0&amp;#125;&#39;&lt;/span&gt;.format(args))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;实现&quot;&gt;&lt;a href=&quot;#实现&quot; class=&quot;headerlink&quot; title=&quot;实现&quot;&gt;&lt;/a&gt;实现&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Model)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# 定义类的属性到列的映射：&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    id = IntegerField(&lt;span class=&quot;string&quot;&gt;&#39;id&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    name = StringField(&lt;span class=&quot;string&quot;&gt;&#39;username&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    email = StringField(&lt;span class=&quot;string&quot;&gt;&#39;email&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    password = StringField(&lt;span class=&quot;string&quot;&gt;&#39;password&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;创建一个实例：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;u = User()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;u.id = &lt;span class=&quot;number&quot;&gt;12345&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;u.name = &lt;span class=&quot;string&quot;&gt;&#39;Michael&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;u.email = &lt;span class=&quot;string&quot;&gt;&#39;test@orm.org&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;u.password = &lt;span class=&quot;string&quot;&gt;&#39;my-pwd&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;保存到数据库：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;u.save()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;结果:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Found model: User&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Found mapping: email ==&amp;gt; StringField:email&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Found mapping: password ==&amp;gt; StringField:password&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Found mapping: id ==&amp;gt; IntegerField:id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Found mapping: name ==&amp;gt; StringField:username&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SQL: insert into User password,email,username,id values ?,?,?,?&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ARGS: [&amp;apos;my-pwd&amp;apos;, &amp;apos;test@orm.org&amp;apos;, &amp;apos;Michael&amp;apos;, 12345]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;关于元类(metaclass)的一些说法:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;元类是类的类&lt;/li&gt;
&lt;li&gt;元类是用来控制如何创建类的&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;本文例子参考&lt;a href=&quot;http://www.liaoxuefeng.com/&quot;&gt;廖雪峰官方网站&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://zonzpoo.github.io/categories/python/"/>
    
    
      <category term="metaclass" scheme="http://zonzpoo.github.io/tags/metaclass/"/>
    
  </entry>
  
  <entry>
    <title>python built-in objects</title>
    <link href="http://zonzpoo.github.io/2016/04/27/python-built-in-objects/"/>
    <id>http://zonzpoo.github.io/2016/04/27/python-built-in-objects/</id>
    <published>2016-04-27T03:11:13.000Z</published>
    <updated>2016-08-13T15:41:03.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;img src=&quot;/images/takephoto1.jpg&quot; alt=&quot;takephoto1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;python2.2后，在内建类和古典类之间引入了新式类(new-style classes). 在新式类中，object是所有内建类型的基类，用户所定义的类可以继承自object也可继承自内建类型&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;内建类型，object，type和用户定义的类之前的关系&quot;&gt;&lt;a href=&quot;#内建类型，object，type和用户定义的类之前的关系&quot; class=&quot;headerlink&quot; title=&quot;内建类型，object，type和用户定义的类之前的关系&quot;&gt;&lt;/a&gt;内建类型，object，type和用户定义的类之前的关系&lt;/h2&gt;&lt;h3 id=&quot;代码举例说明&quot;&gt;&lt;a href=&quot;#代码举例说明&quot; class=&quot;headerlink&quot; title=&quot;代码举例说明&quot;&gt;&lt;/a&gt;代码举例说明&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;A&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&#39;&#39;&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    古典类&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &#39;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;pass&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(object)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&#39;&#39;&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    继承自object&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &#39;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;pass&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(type)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&#39;&#39;&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    type是个元类&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &#39;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;pass&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(dict)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&#39;&#39;&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    继承自dict&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &#39;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;pass&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a, b, c, d = A(), B(), C(&lt;span class=&quot;string&quot;&gt;&#39;F&#39;&lt;/span&gt;, (object,), &amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;value&#39;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&amp;#125;), D()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;求值结果&quot;&gt;&lt;a href=&quot;#求值结果&quot; class=&quot;headerlink&quot; title=&quot;求值结果&quot;&gt;&lt;/a&gt;求值结果&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;对象&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;type(*)&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;*.__class__&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;*.__bases__&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;isinstance(*,object)&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;isinstance(*,type)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;object&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(type ‘type’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(type ‘type’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;()&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;真&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;type&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(type ‘type’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(type ‘type’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(type ‘object’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;真&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;a&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(type ‘instance’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;&lt;strong&gt;main&lt;/strong&gt;.A&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;()&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;真&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;假&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;b&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(class ‘__main__.B’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(class ‘__main__.B’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(type ‘object’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;真&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;假&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;c&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(class ‘__main__.F’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(class ‘__main__.F’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(type ‘type’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;真&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;真&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;d&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(class ‘__main__.D’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(class ‘__main__.D’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;(type ‘dict’)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;真&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;假&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;object和a(古典类实例)无基类，type基类为object&lt;/li&gt;
&lt;li&gt;c是个类，类名为F，type是元类&lt;/li&gt;
&lt;li&gt;object和基于type构建的用户类都是type的实例&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/takephoto1.jpg&quot; alt=&quot;takephoto1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;python2.2后，在内建类和古典类之间引入了新式类(new-style classes). 在新式类中，object是所有内建类型的基类，用户所定义的类可以继承自object也可继承自内建类型&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://zonzpoo.github.io/categories/python/"/>
    
    
      <category term="class" scheme="http://zonzpoo.github.io/tags/class/"/>
    
  </entry>
  
  <entry>
    <title>watchdog模块</title>
    <link href="http://zonzpoo.github.io/2016/04/25/watchdog%E6%A8%A1%E5%9D%97/"/>
    <id>http://zonzpoo.github.io/2016/04/25/watchdog模块/</id>
    <published>2016-04-25T15:26:02.000Z</published>
    <updated>2016-05-29T06:54:10.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;watchdog是python的第三方库，利用操作系统的API来监控目标目录或者文件的变化， 在linux系统下，借用了inotify机制&lt;br&gt;参照observers/__init__.py&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Class&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Platforms&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Note&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Inotify&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Linux 2.6.13+&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;inotify(7) based observer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FSEvents&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Mac OS X&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;FSEvents based observer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Kqueue&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Mac OS X and BSD with kqueue(2)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;kqueue(2) based observer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;WinApi&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;MS Windows&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Windows API-based observer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Polling&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Any&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;fallback implementation&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;watchdog以及需要用的模块介绍&quot;&gt;&lt;a href=&quot;#watchdog以及需要用的模块介绍&quot; class=&quot;headerlink&quot; title=&quot;watchdog以及需要用的模块介绍&quot;&gt;&lt;/a&gt;watchdog以及需要用的模块介绍&lt;/h2&gt;&lt;h3 id=&quot;打开文件操作&quot;&gt;&lt;a href=&quot;#打开文件操作&quot; class=&quot;headerlink&quot; title=&quot;打开文件操作&quot;&gt;&lt;/a&gt;打开文件操作&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;open(name[， mode[， buffering]])&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;name&quot;&gt;&lt;a href=&quot;#name&quot; class=&quot;headerlink&quot; title=&quot;name:&quot;&gt;&lt;/a&gt;name:&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;文件名， 是open函数唯一强制参数&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;mode&quot;&gt;&lt;a href=&quot;#mode&quot; class=&quot;headerlink&quot; title=&quot;mode:&quot;&gt;&lt;/a&gt;mode:&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;值&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;‘r’&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;读模式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;‘w’&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;写模式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;‘a’&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;追加模式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;‘b’&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;二进制模式(可以添加其他模式)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;‘+’&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;读/写模式(可以添加其他模式)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;em&gt;注: 在二进制模式下，不会转换如换行符等&lt;/em&gt;&lt;/p&gt;
&lt;h4 id=&quot;buffering&quot;&gt;&lt;a href=&quot;#buffering&quot; class=&quot;headerlink&quot; title=&quot;buffering:&quot;&gt;&lt;/a&gt;buffering:&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;0|False：I/O输入和输出是无缓冲的(读写操作直接针对磁盘)&lt;/li&gt;
&lt;li&gt;1|True：I/O有缓冲，数据改动存在内存中，flush或close后才会更新磁盘的数据&lt;/li&gt;
&lt;li&gt;大于1：代表缓冲区的大小&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;随机访问操作&quot;&gt;&lt;a href=&quot;#随机访问操作&quot; class=&quot;headerlink&quot; title=&quot;随机访问操作&quot;&gt;&lt;/a&gt;随机访问操作&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;seek(offset[， whence])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tell()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;offset&quot;&gt;&lt;a href=&quot;#offset&quot; class=&quot;headerlink&quot; title=&quot;offset:&quot;&gt;&lt;/a&gt;offset:&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;偏移量， 表示一个字节(字符)数&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;whence&quot;&gt;&lt;a href=&quot;#whence&quot; class=&quot;headerlink&quot; title=&quot;whence:&quot;&gt;&lt;/a&gt;whence:&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;默认为0：表示偏移量从文件开头开始计算的&lt;/li&gt;
&lt;li&gt;值为1：表示相对于当前位置移动(此时offset可以为负数)&lt;/li&gt;
&lt;li&gt;值为2：表示相对于文件结尾的移动&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;tell&quot;&gt;&lt;a href=&quot;#tell&quot; class=&quot;headerlink&quot; title=&quot;tell:&quot;&gt;&lt;/a&gt;tell:&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;该方法返回当前文件的位置&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;watchdog-events-FileSystemEventHandler&quot;&gt;&lt;a href=&quot;#watchdog-events-FileSystemEventHandler&quot; class=&quot;headerlink&quot; title=&quot;watchdog.events.FileSystemEventHandler&quot;&gt;&lt;/a&gt;watchdog.events.FileSystemEventHandler&lt;/h3&gt;&lt;p&gt;基本文件系统事件处理程序&lt;br&gt;可以重载几种方法:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;on_any_event(event)：所有事务的处理程序&lt;/li&gt;
&lt;li&gt;on_created(event)：文件或者目录被创建的时候调用&lt;/li&gt;
&lt;li&gt;on_deleted(event)：文件或目录被删除的时候调用&lt;/li&gt;
&lt;li&gt;on_modified(event)：文件或目录被修改的时候调用&lt;/li&gt;
&lt;li&gt;on_moved(event)：文件或目录被移动或重命名时候调用&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;watchdog-observers-Observer&quot;&gt;&lt;a href=&quot;#watchdog-observers-Observer&quot; class=&quot;headerlink&quot; title=&quot;watchdog.observers.Observer&quot;&gt;&lt;/a&gt;watchdog.observers.Observer&lt;/h3&gt;&lt;p&gt;观察目录并给事件处理程序分配调用&lt;/p&gt;
&lt;h2 id=&quot;watchdog案例&quot;&gt;&lt;a href=&quot;#watchdog案例&quot; class=&quot;headerlink&quot; title=&quot;watchdog案例&quot;&gt;&lt;/a&gt;watchdog案例&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;文件被删除时调用close()&lt;/li&gt;
&lt;li&gt;文件被创建时获得self.fd和self.offset&lt;/li&gt;
&lt;li&gt;文件被新增时打印出新增的内容&lt;/li&gt;
&lt;li&gt;文件被重命名时先关闭原文件再打开新文件并赋值self.fd和self.offset&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;代码实现&quot;&gt;&lt;a href=&quot;#代码实现&quot; class=&quot;headerlink&quot; title=&quot;代码实现:&quot;&gt;&lt;/a&gt;代码实现:&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; os &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; path&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; watchdog.events &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; FileSystemEventHandler&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; watchdog.observers &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Observer&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Watcher&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(FileSystemEventHandler)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self， filename， matcher)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.filename = path.abspath(filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.matcher = matcher&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.observer = Observer()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.fd = &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.offset = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; path.isfile(self.filename):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.fd = open(self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.offset = path.getsize(self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;on_deleted&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self， event)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; path.abspath(event.src_path) == self.filename:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;delete &amp;#123;filename&amp;#125;&#39;&lt;/span&gt;.format(filename=self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.fd.close()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;on_moved&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self， event)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; path.abspath(event.src_path) == self.filename:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;close &amp;#123;filename&amp;#125;&#39;&lt;/span&gt;.format(filename=self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.fd.close()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.filename = path.abspath(event.dest_path)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; path.isfile(self.filename):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;new file &amp;#123;filename&amp;#125;&#39;&lt;/span&gt;.format(filename=self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.fd = open(self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.offset = path.getsize(self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;on_modified&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self， event)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; path.abspath(event.src_path) == self.filename:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.fd.seek(self.offset， &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            match = getattr(self.matcher， &lt;span class=&quot;string&quot;&gt;&#39;match&#39;&lt;/span&gt;， &lt;span class=&quot;keyword&quot;&gt;lambda&lt;/span&gt; x: &lt;span class=&quot;keyword&quot;&gt;False&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; line &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; self.fd:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                line = line.rstrip(&lt;span class=&quot;string&quot;&gt;&#39;\n&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; match(line):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    print(&lt;span class=&quot;string&quot;&gt;&#39;matched &amp;#123;0&amp;#125;&#39;&lt;/span&gt;.format(line))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.offset = self.fd.tell()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;on_created&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self， event)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; path.abspath(event.src_path) == self.filename &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; path.isfile(self.filename):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;create &amp;#123;filename&amp;#125;&#39;&lt;/span&gt;.format(filename=self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.fd = open(self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.offset = path.getsize(self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.observer.schedule(self， path.dirname(self.filename)， recursive=&lt;span class=&quot;keyword&quot;&gt;False&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.observer.start()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.observer.join()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.observer.stop()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; self.fd &lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; self.fd.closed:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.fd.close()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; __name__ == &lt;span class=&quot;string&quot;&gt;&#39;__main__&#39;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Matcher&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self， line)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    w = Watcher(sys.argv[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]， Matcher())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        w.start()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt; KeyboardInterrupt:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        w.stop()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;watchdog是python的第三方库，利用操作系统的API来监控目标目录或者文件的变化， 在linux系统下，借用了inotify机制&lt;br&gt;参照observers/__init__.py&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Class&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Platforms&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Note&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Inotify&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Linux 2.6.13+&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;inotify(7) based observer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FSEvents&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Mac OS X&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;FSEvents based observer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Kqueue&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Mac OS X and BSD with kqueue(2)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;kqueue(2) based observer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;WinApi&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;MS Windows&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Windows API-based observer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Polling&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;Any&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;fallback implementation&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
    
    </summary>
    
      <category term="python" scheme="http://zonzpoo.github.io/categories/python/"/>
    
    
      <category term="watchdog" scheme="http://zonzpoo.github.io/tags/watchdog/"/>
    
  </entry>
  
  <entry>
    <title>Lvs简介</title>
    <link href="http://zonzpoo.github.io/2016/04/14/lvs%E7%AE%80%E4%BB%8B/"/>
    <id>http://zonzpoo.github.io/2016/04/14/lvs简介/</id>
    <published>2016-04-14T05:10:28.000Z</published>
    <updated>2016-04-25T15:23:44.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;LVS是工作在四层的负载平衡调度解决方法，由前端的负载均衡器将请求调度到后端的服务器上，让整个服务器集群的结构对客户是透明的，而客户访问的集群系统提供的网络服务就像访问一台高性能的服务器一样&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;关于lvs的特征&quot;&gt;&lt;a href=&quot;#关于lvs的特征&quot; class=&quot;headerlink&quot; title=&quot;关于lvs的特征&quot;&gt;&lt;/a&gt;关于lvs的特征&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;lvs由ipvsadm和ipvs组成，前者生成规则，后者生效规则&lt;br&gt;lvs是工作在INPUT链上，根据ipvs定义的规则完成转发&lt;br&gt;ipvs工作在netfilter框架上，根据目标请求的套接字上(包括端口的协议TCP/UDP)的转发&lt;br&gt;lvs仅依赖于ip，port等做判断，无法识别应用层内容&lt;br&gt;lvs不依赖套接字，所以获得更好的并发转发机制&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;注:&lt;em&gt;到达用户空间的每个请求连接需要维持套接字文件，并发转发请求受到套件字文件个数的限定(65535)&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&quot;lvs工作机制&quot;&gt;&lt;a href=&quot;#lvs工作机制&quot; class=&quot;headerlink&quot; title=&quot;lvs工作机制&quot;&gt;&lt;/a&gt;lvs工作机制&lt;/h2&gt;&lt;p&gt;前端调度器：Director&lt;br&gt;后端服务器：Real_Server&lt;br&gt;VIP: Director接受用户请求的IP地址, 该地址也需要在Real_Server上配置&lt;br&gt;DIP: Director转发报文给Real_Server的IP地址&lt;br&gt;RIP: Real_Server的IP地址&lt;br&gt;CIP: 客户端的IP地址&lt;br&gt;请求报文经过的IP：&lt;em&gt;CIP –&amp;gt; VIP –&amp;gt; DIP –&amp;gt; RIP&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&quot;lvs工作类型&quot;&gt;&lt;a href=&quot;#lvs工作类型&quot; class=&quot;headerlink&quot; title=&quot;lvs工作类型&quot;&gt;&lt;/a&gt;lvs工作类型&lt;/h2&gt;&lt;h4 id=&quot;NAT模型&quot;&gt;&lt;a href=&quot;#NAT模型&quot; class=&quot;headerlink&quot; title=&quot;NAT模型&quot;&gt;&lt;/a&gt;NAT模型&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;/images/lvs-nat.png&quot; alt=&quot;lvs-nat&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;特性：&quot;&gt;&lt;a href=&quot;#特性：&quot; class=&quot;headerlink&quot; title=&quot;特性：&quot;&gt;&lt;/a&gt;特性：&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;RS(real_server,以下简称RS)应该使用私有地址&lt;br&gt;RS的网关的必须指向DIP, RIP和DIP必须在同一网段内&lt;br&gt;&lt;strong&gt;请求和响应的报文都经过Director&lt;/strong&gt;&lt;br&gt;支持端口映射&lt;br&gt;RS可以使用任意支持集群服务的OS&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;注:&lt;em&gt;此模型下, 请求报文和响应报文都会经过Director, 所以在高负载场景中Director会成为系统性能瓶&lt;/em&gt;&lt;/p&gt;
&lt;h4 id=&quot;DR模型&quot;&gt;&lt;a href=&quot;#DR模型&quot; class=&quot;headerlink&quot; title=&quot;DR模型&quot;&gt;&lt;/a&gt;DR模型&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;/images/lvs-dr.png&quot; alt=&quot;lvs-dr&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;实线是请求过程，虚线是响应过程&lt;/li&gt;
&lt;li&gt;黑色表示RIP，DIP，VIP都是共网地址&lt;/li&gt;
&lt;li&gt;红色表示DIP，VIP是私有地址且在同一个网段&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;此模型下Director发给RS时没有改变目标IP&lt;/strong&gt;&lt;br&gt;需要解决的问题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;让前端路由将请求发往VIP时，只能是Dirctor上的VIP&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;解决方法:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;修改Linux内核参数，将RS上的VIP配置为lo接口的别名，限制Linux仅对对应接口的ARP请求做响应&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;特性：-1&quot;&gt;&lt;a href=&quot;#特性：-1&quot; class=&quot;headerlink&quot; title=&quot;特性：&quot;&gt;&lt;/a&gt;特性：&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;RS可以使用私有地址；但也可以使用公网地址，此时可以直接通过互联网连入RS以实现配监控等&lt;br&gt;RS的网关一定不能指向DIP&lt;br&gt;RS跟Dirctory要在同一物理网络内(不能由路由器分隔)&lt;br&gt;请求报文经过Directory，但响应报文一定不经过Director&lt;br&gt;不支持端口映射&lt;br&gt;RS可以使用大多数的操作系统&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;注: &lt;em&gt;Dirctory上为了便于VIP流动性(keepalived高可用)，Directory应该还有一个自己的外网地址&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&quot;lvs调度算法&quot;&gt;&lt;a href=&quot;#lvs调度算法&quot; class=&quot;headerlink&quot; title=&quot;lvs调度算法&quot;&gt;&lt;/a&gt;lvs调度算法&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;静态方法：仅根据算法本身进行调度&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;rr: Round Robin&lt;/li&gt;
&lt;li&gt;wrr: Weighted RR&lt;/li&gt;
&lt;li&gt;sh: source hashing&lt;/li&gt;
&lt;li&gt;dh: destination hashing&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;动态方法：根据算法及RS当前的负载状况&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;lc: Least Connection Overhead&lt;br&gt;[当前负载]=Active*256+Inactive  结果中，最小者胜出；&lt;/li&gt;
&lt;li&gt;wlc: Weighted LC&lt;br&gt;[考虑权重]Overhead=(Active*256+Inactive)/weight&lt;/li&gt;
&lt;li&gt;sed: Shortest Expect Delay [最小期望延迟]Overhead=(Active+1)*256/weight&lt;/li&gt;
&lt;li&gt;nq: Nerver Queue&lt;/li&gt;
&lt;li&gt;lblc: Locality-based Least Connection  &amp;lt;==&amp;gt; dh+lc&lt;/li&gt;
&lt;li&gt;lblcr: Replicated and Locality-based Least Connection&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;LVS是工作在四层的负载平衡调度解决方法，由前端的负载均衡器将请求调度到后端的服务器上，让整个服务器集群的结构对客户是透明的，而客户访问的集群系统提供的网络服务就像访问一台高性能的服务器一样&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://zonzpoo.github.io/categories/linux/"/>
    
    
      <category term="负载均衡" scheme="http://zonzpoo.github.io/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    
  </entry>
  
  <entry>
    <title>关于Linux进程</title>
    <link href="http://zonzpoo.github.io/2016/04/13/%E5%85%B3%E4%BA%8Elinux%E8%BF%9B%E7%A8%8B/"/>
    <id>http://zonzpoo.github.io/2016/04/13/关于linux进程/</id>
    <published>2016-04-13T05:58:59.000Z</published>
    <updated>2016-04-25T15:24:14.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;在Linux系统中,触发任何一个事件时,系统都会将’它’定义为一个process,并给与其PID,同时根据启动’它’的使用者和相关属性关系,给与PID一组有效的权限配置,而program通常为binary program，一般放置于存储媒体(磁盘等)中。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;关于Linux进程&quot;&gt;&lt;a href=&quot;#关于Linux进程&quot; class=&quot;headerlink&quot; title=&quot;关于Linux进程&quot;&gt;&lt;/a&gt;关于Linux进程&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;1，init是内核开启之后启动的第一个用户级进程,用来产生所有其他进程的程序,进程号为1&lt;br&gt;2，进程由内核调度,进程意识不到其他进程的存在,父进程要终止子进程需要向内核申请。&lt;br&gt;3，内核通过双向循环链表找到每个进程的数据结构(task_struct:（进程号,进程名,进程的父进程,进程分配的内存地址,进程使用的cpu信息等)，进而追踪所有的进程&lt;br&gt;4，双向循环链表:每个数据结构尾部有段空间存储了下一个数据结构的位置信息,首部存储了上一个数据结构的位置信息&lt;br&gt;5，和进程相关的信息一般映射至/proc目录下,作为伪文件系统&lt;br&gt;6，由于线程是内核库支持的编程模型实现的,所以linux不属于真正意义上的线程操作系统。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;Linux进程管理工具&quot;&gt;&lt;a href=&quot;#Linux进程管理工具&quot; class=&quot;headerlink&quot; title=&quot;Linux进程管理工具&quot;&gt;&lt;/a&gt;Linux进程管理工具&lt;/h2&gt;&lt;h4 id=&quot;top&quot;&gt;&lt;a href=&quot;#top&quot; class=&quot;headerlink&quot; title=&quot;top&quot;&gt;&lt;/a&gt;&lt;strong&gt;top&lt;/strong&gt;&lt;/h4&gt;&lt;p&gt;常用选项：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; -d #： 指定刷新时间间隔&lt;br&gt; -b：以批次显示top的刷新&lt;br&gt; -n #：指定显示的次数&lt;br&gt; 注意：-b -n # 显示批次刷新次数&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;top - 22:43:21 up 24 days, 13:17,  1 user,  load average: 0.00, 0.03, 0.05&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Tasks: 159 total,   2 running, 157 sleeping,   0 stopped,   0 zombie&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;%Cpu(s):  0.3 us,  0.3 sy,  0.0 ni, 99.3 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;KiB Mem:   2048464 total,  1268048 used,   780416 free,    71160 buffers&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;KiB Swap:  4194300 total,    71864 used,  4122436 free.   245404 cached Mem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND                                                                          &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 2305 root      20   0  463496   8448   1672 S  0.3  0.4  22:22.89 AliYunDunUpdate                                                                  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 2403 root      20   0  141932   5748   3564 S  0.3  0.3  56:54.12 AliYunDun                                                                        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    1 root      20   0   33472   2460   1128 S  0.0  0.1   0:01.75 init&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;字段表示含义：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; 2，load average  平均1分钟/5分钟/15分钟CPU负载&lt;br&gt; 3，total|running|sleeping|stopped|zombie 总进程数|运行|休眠|停止|僵死&lt;br&gt; 4，us:用户空间占用cpu百分比&lt;br&gt; 5，sy:系统占用cpu百分比&lt;br&gt; 6，ni:nice值调整过的进程占用cpu百分比&lt;br&gt; 7，id:空闲百分比&lt;br&gt; 8，wa:等待I/O完成占用百分比&lt;br&gt; 9，hi|si:硬件|软件中断占用百分比&lt;br&gt; 10，st:被偷走的所占用百分比&lt;br&gt; 11，Mem|Swap后面的值表示总共，已用，空闲，缓冲&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;操作：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;M: 按内存占用百分比大小排序&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;P：按CPU占用百分比大小排序，默认；&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;T：按累积占用CPU时长大小排序&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;l: 是否显示负载信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;t: 是否显示CPU和进程的统计信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;m: 是否显示内存摘要信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;q: 退出	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;k: kill，终止一个进程   9/15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;s: 改变top刷新时间间隔&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;vmstat&quot;&gt;&lt;a href=&quot;#vmstat&quot; class=&quot;headerlink&quot; title=&quot;vmstat&quot;&gt;&lt;/a&gt;&lt;strong&gt;vmstat&lt;/strong&gt;&lt;/h4&gt;&lt;p&gt;常用选项：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-s：显示内存统计数据&lt;br&gt;1 3：表示1秒刷新一次，显示三次&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0  0  71860 778976  72356 245420    0    0     3    45    1   16  1  1 98  0  0&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;r：运行或等待CPU时间片的进程的个数&lt;br&gt;b：被阻塞(通常为等待I/O完成)的进程队列的个数&lt;br&gt;swpd：从物理内存交换至swap中的数据量&lt;br&gt;free：未使用物理内存大小&lt;br&gt;buffer：buffer空间大小，通常与缓存写操作相关&lt;br&gt;cache：cache空间大小，通常与缓存读操作相关&lt;br&gt;si: swap in，数据进入swap中的数据量，通常是速率[kb/s]&lt;br&gt;so: swap out，数据离开swap的数据量&lt;br&gt;bi: block in，从块设备读入的数据量，通常是速率[kb/s]&lt;br&gt;bo: block out，保存至块设备中的数据量，通常是速率[kb/s]&lt;br&gt;in: 中断发生速率，每秒的中断数&lt;br&gt;cs: context switch(上下文切换)，进程切换，通常为每秒钟切换的次数&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;ps&quot;&gt;&lt;a href=&quot;#ps&quot; class=&quot;headerlink&quot; title=&quot;ps&quot;&gt;&lt;/a&gt;&lt;strong&gt;ps&lt;/strong&gt;&lt;/h4&gt;&lt;p&gt;STAT 进程状态：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;R: 运行或可运行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;S: 可中断的睡眠状态&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;D: 不可中断的睡眠状态&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;T：停止 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Z：僵死&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;s：会话领导者(session leader)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+：前台进程&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;l：多线程进程&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;N：低优先级进程&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;： 高优先级进程&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[]：表示内核线程&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-a | x：所有和终端相关|无关的进程&lt;br&gt;-u：以用户为中心显示进程相关信息&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;~$ ps aux&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root         1  0.0  0.1  33472  2460 ?        Ss   Mar14   0:01 /sbin/init&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;%cpu：cputime/realtime&lt;/em&gt;&lt;br&gt;&lt;em&gt;%MEM：占用内存/实际内存&lt;/em&gt;&lt;br&gt;&lt;em&gt;VSZ: 线性地址空间大小(Virutal memory SiZe)&lt;/em&gt;&lt;br&gt;&lt;em&gt;RSS: 非交互物理内存空间(常驻内存集)&lt;/em&gt;&lt;br&gt;&lt;em&gt;TTY: ‘?’表示与终端无关的进程&lt;/em&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-e：显示所有进程&lt;br&gt;-f：显示完整格式列表&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ps -ef&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;UID        PID  PPID  C STIME TTY          TIME CMD&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root         1     0  0 Mar14 ?        00:00:01 /sbin/init&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;-F：显示额外信息&lt;br&gt;-H：显示进程的层次信息&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ps -eFH&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;UID        PID  PPID  C    SZ   RSS PSR STIME TTY          TIME CMD&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root         2     0  0     0     0   0 Mar14 ?        00:00:00 [kthreadd]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root         3     2  0     0     0   0 Mar14 ?        00:00:11   [ksoftirqd/0]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root         5     2  0     0     0   0 Mar14 ?        00:00:00   [kworker/0:0H]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;PSR：表示运行在哪个cpu上&lt;/em&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-o：表示自定义要显示的信息&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ps axo pid,command,ni&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  PID COMMAND                      NI&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    1 /sbin/init                    0&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;rtprio: 实时优先级&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ni：nice值&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pri：优先级&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;psr：运行的cpu&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;pmap：显示一个进程占用的内存&quot;&gt;&lt;a href=&quot;#pmap：显示一个进程占用的内存&quot; class=&quot;headerlink&quot; title=&quot;pmap：显示一个进程占用的内存&quot;&gt;&lt;/a&gt;&lt;strong&gt;pmap&lt;/strong&gt;：显示一个进程占用的内存&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ sudo pmap -x 7066&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Address           Kbytes     RSS   Dirty Mode  Mapping&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0000000000400000     772     464       0 r-x-- nginx&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;00000000006c0000       4       4       4 r---- nginx&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt; Address：起始地址&lt;br&gt; Kbytes：占用内存的大小&lt;br&gt; RSS：常驻内存集&lt;br&gt; Dirty：脏页(修改过当尚未同步到磁盘上的数据大小)&lt;br&gt; MODE：读-写-执行-共享-私有&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;nice：手动调整进程优先级，数值越小，优先级越高&quot;&gt;&lt;a href=&quot;#nice：手动调整进程优先级，数值越小，优先级越高&quot; class=&quot;headerlink&quot; title=&quot;nice：手动调整进程优先级，数值越小，优先级越高&quot;&gt;&lt;/a&gt;&lt;strong&gt;nice&lt;/strong&gt;：手动调整进程优先级，数值越小，优先级越高&lt;/h4&gt;&lt;p&gt;进程的nice值为-20~19之间，默认nice为0&lt;br&gt;&lt;strong&gt;注：非管理员用户只能调大nice值&lt;/strong&gt;&lt;br&gt;对于尚未启动的程序：nice -n # COMMAND&lt;br&gt;对于运行中的进程：renice # PID&lt;/p&gt;
&lt;h2 id=&quot;Linux进程间通信-IPC&quot;&gt;&lt;a href=&quot;#Linux进程间通信-IPC&quot; class=&quot;headerlink&quot; title=&quot;Linux进程间通信(IPC)&quot;&gt;&lt;/a&gt;Linux进程间通信(IPC)&lt;/h2&gt;&lt;h4 id=&quot;1，kill：用于向其他进程发送消息&quot;&gt;&lt;a href=&quot;#1，kill：用于向其他进程发送消息&quot; class=&quot;headerlink&quot; title=&quot;1，kill：用于向其他进程发送消息&quot;&gt;&lt;/a&gt;1，&lt;strong&gt;kill&lt;/strong&gt;：用于向其他进程发送消息&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-l| -SIGNAL：显示可以接受的信号&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;常用的信号：(可以写出1|SIGHUP|HUP)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; 1）SIGHUP：让程序重读配置文件，而不重启程序&lt;br&gt; 2）SIGINT：中断信号，相当于Ctrl+c即发送此信息&lt;br&gt; 9）SIGKILL：杀死进程&lt;br&gt; 15）SIGTERM：终止进程&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;start-stop-daemon --stop --signal HUP --quiet --pidfile /var/run/nginx.pid --name nginx&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;该命令会检查nginx进程是否存在，如果存在发送SIGHUP信号，让进程重读配置文件，成功返回0，如果进程不存在，该命令会退出并返回1&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;在Linux系统中,触发任何一个事件时,系统都会将’它’定义为一个process,并给与其PID,同时根据启动’它’的使用者和相关属性关系,给与PID一组有效的权限配置,而program通常为binary program，一般放置于存储媒体(磁盘等)中。&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://zonzpoo.github.io/categories/linux/"/>
    
    
      <category term="进程" scheme="http://zonzpoo.github.io/tags/%E8%BF%9B%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>关于Linux文件系统</title>
    <link href="http://zonzpoo.github.io/2016/04/06/%E5%85%B3%E4%BA%8ELinux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"/>
    <id>http://zonzpoo.github.io/2016/04/06/关于Linux文件系统/</id>
    <published>2016-04-06T13:03:32.000Z</published>
    <updated>2016-04-14T10:41:50.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;文件系统是在内核中实现，能够对存储在磁盘上的二进制数据进行有效的层次化管理的一种软件。而用户程序为了实现在磁盘上使用或者创建文件，向内核发起系统调用(实际由文件系统向内核发起的系统调用)并转换为对应磁盘设备的电气信号的请求(数据存储在硬盘上,用户的”0,1”代码信号数据转换成磁盘能识别的存储机制)。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;MBR：主引导记录&quot;&gt;&lt;a href=&quot;#MBR：主引导记录&quot; class=&quot;headerlink&quot; title=&quot;MBR：主引导记录&quot;&gt;&lt;/a&gt;MBR：主引导记录&lt;/h2&gt;&lt;p&gt;分区信息放在主引导记录中，为了让操作系统能识别分区&lt;br&gt;MBR(512bytes):&lt;br&gt;1，bootloader(引导加载器)：446bytes&lt;br&gt;2，fat(文件系统分配表)：64bytes(16bytes一个分区，共4个分区)&lt;br&gt;3，5A(MBR有效性标记)：2bytes&lt;br&gt;&lt;strong&gt;注：3个主分区，1扩展分区：引用额外的分区表–划分为逻辑分区&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;文件系统&quot;&gt;&lt;a href=&quot;#文件系统&quot; class=&quot;headerlink&quot; title=&quot;文件系统&quot;&gt;&lt;/a&gt;文件系统&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;特性&lt;/strong&gt;:&lt;br&gt;文件系统通常将权限和属性放置于inode中,实际数据则放到data block中,还有一个超级块会记录整个文件系统的整体信息,包括inode和block的总量,使用量和剩余量&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;super block：记录此文件系统的整体信息,inode和block的总量,使用量和剩余量和文件系统的格式和相关信息&lt;br&gt;inode：记录文件的属性,一个文件占用一个inode,同时记录此文件数据所在的block号码&lt;br&gt;block：实际记录文件内容,文件过大时,会占用多个block&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;基本功能是按文件名称实现存取，所以各文件系统的不同指内部存放读取文件(内部的实现细节)的格式不同。&lt;br&gt;&lt;strong&gt;注：计算器上，当两个层次不能结合时，就需要添加中间层&lt;/strong&gt;&lt;br&gt;VFS：虚拟文件系统(中间层)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1，基本文件系统：Ext2，Ext3，Ext4，Reiserfs，xfs，JFS，vfat，NTFS&lt;br&gt;2，交换分区：Swap&lt;br&gt;3，集群文件系统：GFS2，OCFS2&lt;br&gt;4，网络文件系统：NFS，Smbfs(CIFS)&lt;br&gt;5，光盘文件系统：ISO9660&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;磁盘管理工具&quot;&gt;&lt;a href=&quot;#磁盘管理工具&quot; class=&quot;headerlink&quot; title=&quot;磁盘管理工具&quot;&gt;&lt;/a&gt;磁盘管理工具&lt;/h2&gt;&lt;h4 id=&quot;fdisk查看磁盘分区列表以及实现磁盘分区管理&quot;&gt;&lt;a href=&quot;#fdisk查看磁盘分区列表以及实现磁盘分区管理&quot; class=&quot;headerlink&quot; title=&quot;fdisk查看磁盘分区列表以及实现磁盘分区管理&quot;&gt;&lt;/a&gt;&lt;strong&gt;fdisk&lt;/strong&gt;查看磁盘分区列表以及实现磁盘分区管理&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Sector size (logical/physical): 512 bytes / 512 bytes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;I/O size (minimum/optimal): 512 bytes / 512 bytes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Disk identifier: 0x000da36d&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Device Boot      Start         End      Blocks   Id  System&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/dev/xvda1   *        2048    41940991    20969472   83  Linux&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Sector size：每块扇区512bytes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;I/O size：一次I/O操作读取的数据量&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Disk identifier：disk的唯一标识符(16进制)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Device：分区&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Boot： &amp;apos;*&amp;apos; =&amp;gt; 表示可引导分区&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Start：表示起始柱面&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;End：表示结束柱面&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Blocks：块数&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Id：文件系统的id号&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;d：删除&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;n：新建&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p：列出已有分区&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;t：调整分区ID&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;l：列出内核支持的分区ID&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;w：存盘并退出&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;q：不保存退出&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;kpartx-partx通知内核重读硬件设备的分区信息表&quot;&gt;&lt;a href=&quot;#kpartx-partx通知内核重读硬件设备的分区信息表&quot; class=&quot;headerlink&quot; title=&quot;kpartx|partx通知内核重读硬件设备的分区信息表&quot;&gt;&lt;/a&gt;&lt;strong&gt;kpartx&lt;/strong&gt;|&lt;strong&gt;partx&lt;/strong&gt;通知内核重读硬件设备的分区信息表&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-a：添加分区信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-f：强制添加&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cat  /proc/partitions: 查看分区信息&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;mke2fs创建ext文件系统&quot;&gt;&lt;a href=&quot;#mke2fs创建ext文件系统&quot; class=&quot;headerlink&quot; title=&quot;mke2fs创建ext文件系统&quot;&gt;&lt;/a&gt;&lt;strong&gt;mke2fs&lt;/strong&gt;创建ext文件系统&lt;/h4&gt;&lt;p&gt;配置文件：/etc/mke2fs.conf&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-t 指定文件系统类型  &amp;#123;ext2|ext3|ext4&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-L Label  指定卷标    e2label（此命令可以查看/指定磁盘接口设备文件名的卷标）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-b：&amp;#123;1024|2048|4096&amp;#125; 指定块大小(小文件多时使用小磁盘块)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-O：指定分区特性&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-#：#个字节预留一个inode&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-N #：指定预留的inode数目&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-I #：Inode大小(inode保存元数据信息:文件大小，属主属组，存放的磁盘块位置)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-m #：预留给管理员的空间百分比，默认为5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注：超级块中存放块组信息，块分配情况(有备份)&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&quot;e2label创建ext文件系统&quot;&gt;&lt;a href=&quot;#e2label创建ext文件系统&quot; class=&quot;headerlink&quot; title=&quot;e2label创建ext文件系统&quot;&gt;&lt;/a&gt;&lt;strong&gt;e2label&lt;/strong&gt;创建ext文件系统&lt;/h4&gt;&lt;p&gt;查看卷标和设定卷标&lt;/p&gt;
&lt;h4 id=&quot;dumpe2fs查看块信息&quot;&gt;&lt;a href=&quot;#dumpe2fs查看块信息&quot; class=&quot;headerlink&quot; title=&quot;dumpe2fs查看块信息&quot;&gt;&lt;/a&gt;&lt;strong&gt;dumpe2fs&lt;/strong&gt;查看块信息&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-h：仅查看超级块中保存的信息&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;tune2fs查看或调整ext文件系统信息&quot;&gt;&lt;a href=&quot;#tune2fs查看或调整ext文件系统信息&quot; class=&quot;headerlink&quot; title=&quot;tune2fs查看或调整ext文件系统信息&quot;&gt;&lt;/a&gt;&lt;strong&gt;tune2fs&lt;/strong&gt;查看或调整ext文件系统信息&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-l：显示超级块信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-L label：设定卷标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-m：预留管理员空间百分比&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-j：如果原文件系统为ext2，-J能够将其提升为ext3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-o：设定其默认挂载选项&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-O：调整分区特性(^表示关闭该特性)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ex:tune2fs -O ^huge_file /dev/sda3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;fsck-e2fsck检查修复文件系统的命令&quot;&gt;&lt;a href=&quot;#fsck-e2fsck检查修复文件系统的命令&quot; class=&quot;headerlink&quot; title=&quot;fsck|e2fsck检查修复文件系统的命令&quot;&gt;&lt;/a&gt;&lt;strong&gt;fsck&lt;/strong&gt;|&lt;strong&gt;e2fsck&lt;/strong&gt;检查修复文件系统的命令&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-t：指定文件系统&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-f：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-a：自动修复错误&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-r：交互式修复错误&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;关于交换分区-虚拟内存&quot;&gt;&lt;a href=&quot;#关于交换分区-虚拟内存&quot; class=&quot;headerlink&quot; title=&quot;关于交换分区(虚拟内存)&quot;&gt;&lt;/a&gt;&lt;strong&gt;关于交换分区(虚拟内存)&lt;/strong&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;注：交换分区格式化后内部的存储格式和内存一样,必须是单独分区&lt;/strong&gt;&lt;br&gt;当物理内存容量过低时，把部分不经常使用数据置换到交换分区上，单位是页面(page)，页面大小取决于cpu。&lt;/p&gt;
&lt;p&gt;linux使用物理内存和交换分区的比例通过/proc/sys/vm/swapiness文件定义&lt;/p&gt;
&lt;h6 id=&quot;mkswap-创建交换分区&quot;&gt;&lt;a href=&quot;#mkswap-创建交换分区&quot; class=&quot;headerlink&quot; title=&quot;mkswap 创建交换分区&quot;&gt;&lt;/a&gt;&lt;strong&gt;mkswap&lt;/strong&gt; 创建交换分区&lt;/h6&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-L：指定label&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&quot;swapon-swapoff-启动和关闭交换分区&quot;&gt;&lt;a href=&quot;#swapon-swapoff-启动和关闭交换分区&quot; class=&quot;headerlink&quot; title=&quot;swapon|swapoff 启动和关闭交换分区&quot;&gt;&lt;/a&gt;&lt;strong&gt;swapon&lt;/strong&gt;|&lt;strong&gt;swapoff&lt;/strong&gt; 启动和关闭交换分区&lt;/h6&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-a：标记所有swap为启用状态&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-P #：指定启用的swap优先级&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;hdparm-读取或设置设备信息&quot;&gt;&lt;a href=&quot;#hdparm-读取或设置设备信息&quot; class=&quot;headerlink&quot; title=&quot;hdparm 读取或设置设备信息&quot;&gt;&lt;/a&gt;&lt;strong&gt;hdparm&lt;/strong&gt; 读取或设置设备信息&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-i：从内核读取&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-I：从磁盘读取&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;文件信息查看&quot;&gt;&lt;a href=&quot;#文件信息查看&quot; class=&quot;headerlink&quot; title=&quot;文件信息查看&quot;&gt;&lt;/a&gt;&lt;strong&gt;文件信息查看&lt;/strong&gt;&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/proc/cpuinfo：cpu信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/proc/partitions：分区信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/proc/meminfo：内存信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/proc/filesystems：内核识别的文件系统信息&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/proc/mounts：挂载信息&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;mount-umount-挂载&quot;&gt;&lt;a href=&quot;#mount-umount-挂载&quot; class=&quot;headerlink&quot; title=&quot;mount|umount 挂载&quot;&gt;&lt;/a&gt;&lt;strong&gt;mount&lt;/strong&gt;|&lt;strong&gt;umount&lt;/strong&gt; 挂载&lt;/h4&gt;&lt;p&gt;创建完文件系统后，需要和当前系统上一个空闲目录关联起来，作为其访问入口&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mount [options] [-t fstype] [-o option]  device  挂载点(空闲目录)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-t：文件系统类型&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-r：只读挂载&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-w：读写挂载&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-L：用卷标指定设备&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-U：UUID指定设备&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-a：挂载所有支持自动挂载的设备&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-o 选项：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   async：异步I/O，数据的写入操作在内存中完成，然后由内核统一同步磁盘上去&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   sync：同步I/O&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   atime/noatime：更新文件访问时间戳(建议noatime)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   auto/noauto：是否能够被 mount -a选择自动挂载&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   diratime/nodiratime：是否更新目录的访问时间戳&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   exec/noexec：是否允许执行其中的二进制程序&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   iversion/noiversion：inode修改后，i_version是否+1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   _netdev：网络功能启用前不会挂载此种网络设备&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   remount：重新挂载&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   acl：启用facl(磁盘分区特性)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注：挂载点挂载后，其原有目录下的文件或目录会被隐藏，卸载后能显示&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;注：内核启动时只挂着根文件系统所在分区，其他分区的文件系统&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&quot;fuser&quot;&gt;&lt;a href=&quot;#fuser&quot; class=&quot;headerlink&quot; title=&quot;fuser&quot;&gt;&lt;/a&gt;&lt;strong&gt;fuser&lt;/strong&gt;&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-km 挂载点  踢出占用挂载设备的进程&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-v 挂载点  查看占用挂载设备的进程&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;df-磁盘空间使用状态报告&quot;&gt;&lt;a href=&quot;#df-磁盘空间使用状态报告&quot; class=&quot;headerlink&quot; title=&quot;df  磁盘空间使用状态报告&quot;&gt;&lt;/a&gt;&lt;strong&gt;df&lt;/strong&gt;  磁盘空间使用状态报告&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-h：hunman-readable&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-i：查看inode使用情况&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-P：POSIX效果显示&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;du-评估文件占用磁盘空间情况&quot;&gt;&lt;a href=&quot;#du-评估文件占用磁盘空间情况&quot; class=&quot;headerlink&quot; title=&quot;du  评估文件占用磁盘空间情况&quot;&gt;&lt;/a&gt;&lt;strong&gt;du&lt;/strong&gt;  评估文件占用磁盘空间情况&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-sh：hunman-readable显示目录占用磁盘总大小&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;dd：更低级别的复制工具&quot;&gt;&lt;a href=&quot;#dd：更低级别的复制工具&quot; class=&quot;headerlink&quot; title=&quot;dd：更低级别的复制工具&quot;&gt;&lt;/a&gt;&lt;strong&gt;dd&lt;/strong&gt;：更低级别的复制工具&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;dd if=input_file of=out_file bs=#[b|k|m|g] count=# &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#表示数字&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;注：copy命令发起系统调用读取一个文件，在新位置创建新文件，把之前读取的文件数据写入到新的文件中；dd命令直接复制磁盘块到另一个位置&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;关于-etc-fstab&quot;&gt;&lt;a href=&quot;#关于-etc-fstab&quot; class=&quot;headerlink&quot; title=&quot;关于/etc/fstab&quot;&gt;&lt;/a&gt;关于/etc/fstab&lt;/h2&gt;&lt;p&gt;fstab文件中定义了文件系统挂载表，在系统初始化脚本/etc/rc.d/rc.sysinit中定义开机读取fstab&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# &amp;lt;file system&amp;gt; &amp;lt;mount point&amp;gt;   &amp;lt;type&amp;gt;  &amp;lt;options&amp;gt;  &amp;lt;dump&amp;gt;  &amp;lt;pass&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ex: UUID=af414ad8-9936-46cd-b074-528854656fcd / ext4 errors=remount-ro 0 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;file system&amp;gt;：挂载的设备&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;mount point&amp;gt;：挂载点(swap挂载点是swap)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;type&amp;gt;：文件系统类型&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;options&amp;gt;：挂载选项,逗号隔开多个选项&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;dump&amp;gt;：转储(备份)频率，0-从不备份，1-每日备份&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;pass&amp;gt;：自检次序，1表示该挂载点首先自检，通常只能被/使用，0表示不自检&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;文件链接&quot;&gt;&lt;a href=&quot;#文件链接&quot; class=&quot;headerlink&quot; title=&quot;文件链接&quot;&gt;&lt;/a&gt;文件链接&lt;/h2&gt;&lt;h4 id=&quot;ln-ln-SRC-LINKFILE&quot;&gt;&lt;a href=&quot;#ln-ln-SRC-LINKFILE&quot; class=&quot;headerlink&quot; title=&quot;ln(ln SRC LINKFILE)&quot;&gt;&lt;/a&gt;&lt;strong&gt;ln&lt;/strong&gt;(ln SRC LINKFILE)&lt;/h4&gt;&lt;p&gt;硬链接：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; 指向同一个inode号的两个不同路径(inode号指向不能跨分区)
&amp;gt; 不能对目录创建硬链接
&amp;gt; 硬链接会改变文件链接的次数
&lt;/code&gt;&lt;/pre&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-rw-r--r-- 1  root  root  260 Jul 29 2015  backup-my.cnf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;其中 1 表示文件的硬链接次数&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;软链接(符号链接)：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; 符号链接文件内记录原文件的路径(**大小为路径的字符串数**)
&amp;gt; 可以跨分区
&amp;gt; 跟原文件不同一个inode
&amp;gt; 可以对目录创建符号链接
&amp;gt; 符号链接不会改变源文件被链接的次数
&lt;/code&gt;&lt;/pre&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;lrwxrwxrwx 1 root root    7 Apr  5 2016 test1.sh -&amp;gt; test.sh&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-rw-rw-r-- 1 root root 1342 Jul 13 2015 test.sh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;压缩工具&quot;&gt;&lt;a href=&quot;#压缩工具&quot; class=&quot;headerlink&quot; title=&quot;压缩工具&quot;&gt;&lt;/a&gt;压缩工具&lt;/h2&gt;&lt;h4 id=&quot;gzip&quot;&gt;&lt;a href=&quot;#gzip&quot; class=&quot;headerlink&quot; title=&quot;gzip&quot;&gt;&lt;/a&gt;&lt;strong&gt;gzip&lt;/strong&gt;&lt;/h4&gt;&lt;p&gt;zcat：不解压直接查看压缩文件原内容&lt;br&gt;后缀为(.gz)&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-d：解压缩[gunzip]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-#：#为数字指定压缩比(1-9),压缩比越大占用cpu时钟周期越多,效率越低&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-c：将压缩结果到标准输出,可使用重定向将其保存为压缩文件,从而保存原文件&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;bzip2-压缩比率比gzip大&quot;&gt;&lt;a href=&quot;#bzip2-压缩比率比gzip大&quot; class=&quot;headerlink&quot; title=&quot;bzip2(压缩比率比gzip大)&quot;&gt;&lt;/a&gt;&lt;strong&gt;bzip2&lt;/strong&gt;(压缩比率比gzip大)&lt;/h4&gt;&lt;p&gt;bzcat：不解压直接查看压缩文件原内容&lt;br&gt;后缀为(.bz2)&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-d：解压缩[bunzip2]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-#：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-c：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-k：压缩完后保存原文件&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;xz-压缩比率最大&quot;&gt;&lt;a href=&quot;#xz-压缩比率最大&quot; class=&quot;headerlink&quot; title=&quot;xz(压缩比率最大)&quot;&gt;&lt;/a&gt;&lt;strong&gt;xz&lt;/strong&gt;(压缩比率最大)&lt;/h4&gt;&lt;p&gt;xzcat：不解压直接查看压缩文件原内容&lt;br&gt;后缀为(.xz)&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-d：解压缩[unxz]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-#：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-c：&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;zip-unzip：归档压缩工具-可以压缩目录&quot;&gt;&lt;a href=&quot;#zip-unzip：归档压缩工具-可以压缩目录&quot; class=&quot;headerlink&quot; title=&quot;zip|unzip：归档压缩工具(可以压缩目录)&quot;&gt;&lt;/a&gt;&lt;strong&gt;zip&lt;/strong&gt;|&lt;strong&gt;unzip&lt;/strong&gt;：归档压缩工具(可以压缩目录)&lt;/h4&gt;&lt;h4 id=&quot;tar：归档工具&quot;&gt;&lt;a href=&quot;#tar：归档工具&quot; class=&quot;headerlink&quot; title=&quot;tar：归档工具&quot;&gt;&lt;/a&gt;&lt;strong&gt;tar&lt;/strong&gt;：归档工具&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;tar [option] -f file.tar pathname&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-c：创建归档&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-x：还原归档 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-t：不展开直接查看被归档的文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-zcf：调用gzip&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-jcf：调用bzip2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-Jcf：调用xz&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;注：tar命令可以根据文件后缀在解压缩时自动调用相应的解压缩工具(-xf)&lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;文件系统是在内核中实现，能够对存储在磁盘上的二进制数据进行有效的层次化管理的一种软件。而用户程序为了实现在磁盘上使用或者创建文件，向内核发起系统调用(实际由文件系统向内核发起的系统调用)并转换为对应磁盘设备的电气信号的请求(数据存储在硬盘上,用户的”0,1”代码信号数据转换成磁盘能识别的存储机制)。&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://zonzpoo.github.io/categories/linux/"/>
    
    
      <category term="文件系统" scheme="http://zonzpoo.github.io/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
</feed>
